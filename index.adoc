= MONARC Objects Sharing Platform
CASES Luxembourg <info@cases.lu>
v{docdate}
:encoding: utf-8
:Revision: 0.1
:description: MONARC Objects Sharing Platform
:keywords: risk-analysis, monarc, MOSP
:imagesdir: images
:title-logo-image: image:Logotype_Monochrome_Black.svg[]
:doctype: article
:compat-mode!:
:page-layout!:
:toc: left
:toclevels: 3
:sectanchors:
:sectlinks:
:sectnums:
:linkattrs:
:webfonts!:
:icons: font
:source-highlighter: coderay
:source-language: asciidoc
:experimental:
:stem:
:idprefix:
:idseparator: -
:ast: &ast;
:dagger: pass:normal[^&dagger;^]
:endash: &#8211;
:y: icon:check[role="green"]
:n: icon:times[role="red"]
:c: icon:file-text-o[role="blue"]
:table-caption!:
:example-caption!:
:figure-caption!:
:includedir: _includes
:underscore: _
:adp: AsciiDoc Python
:adr: Asciidoctor
// Refs
:uri-github-mosp: https://github.com/CASES-LU/MOSP
:uri-mosp: http://objects.monarc.lu
:uri-monarc-fo: https://github.com/monarc-project/MonarcAppFO
:uri-monarc-bo: https://github.com/monarc-project/MonarcAppBO


== Introduction

=== JSON schema

A JSON schema describes and validates your existing data format(s).
This ensures the quality of client submitted data.
MOSP also uses JSON schemas for the generation of the object editor.

For example the JSON schema available here validates the Security
referentials used in MONARC.
When creating a new object with MOSP you have first to choose a JSON schema.

You can use any available schemas in order to create shareable JSON objects.
It is possible to keep an object private even if the goal of this platform is
to promote the sharing of information. JSON schemas are always public.

=== Objects



== Creating a new object

=== Select a schema

image:new-object-from-schema.png[EditionJsonObject]


=== Edit object definition

image:object-json-edition.png[EditionJsonObject]


== Exporting an object for use in MONARC



== Using the API

An API is provided in order to interact with the service programmatically.


=== Endpoint for Schemas

Getting the list of schemas:
[source,bash]
----
https://objects.monarc.lu/api/v1/schema
----


Getting information about a schema:
[source,bash]
----
https://objects.monarc.lu/api/v1/schema/13
----


=== Endpoint for JSON objects

==== Getting the list of JSON objects

[source,bash]
----
https://objects.monarc.lu/api/v1/json_object
----


==== Creating a new object

[source,bash]
----
# json_object='{}'
# curl -i --user username:password \
    -H "Content-Type: application/json" \
    -H "Accept: application/json" -X POST \
    -d '{"name":"NIST","description":"Recommended Security Controls for Federal Information Systems and Organizations. (Rev.5)" ,"org_id":2,"json_object":'"$json_object"'}' \
    https://objects.monarc.lu/api/v1/json_object

HTTP/1.0 400 BAD REQUEST
Content-Type: application/json
Content-Length: 85
Vary: Cookie

{
  "message": "You are not allowed to create/edit object from this organization."
}
----



[source,bash]
----
# json_object='{}'
# curl -i --user username:password \
    -H "Content-Type: application/json" \
    -H "Accept: application/json" -X POST \
    -d '{"name":"NIST","description":"Recommended Security Controls for Federal Information Systems and Organizations. (Rev.5)" ,"org_id":3,"json_object":'"$json_object"'}' \
    https://objects.monarc.lu/api/v1/json_object

HTTP/1.0 400 BAD REQUEST
Content-Type: application/json
Content-Length: 85
Vary: Cookie
Date: Thu, 21 Feb 2019 09:07:26 GMT

{
  "message": "You must provide the id of a schema."
}
----




[source,bash]
----
# json_object='{}'
# curl -i --user username:password \
    -H "Content-Type: application/json" \
    -H "Accept: application/json" -X POST \
    -d '{"name":"NIST","description":"Recommended Security Controls for Federal Information Systems and Organizations. (Rev.5)" ,"org_id":3,"schema_id":12,"json_object":'"$json_object"'}' \
    https://objects.monarc.lu/api/v1/json_object

HTTP/1.0 400 BAD REQUEST
Content-Type: application/json
Content-Length: 85
Vary: Cookie
Date: Thu, 21 Feb 2019 09:07:26 GMT

{
  "message": "The object submitted is not validated by the schema."
}
----



[source,bash]
----
# json_object='{"label":"NIST SP 800-53","measures":[{"category": "Access Control","code": "AC-1","label": "Access Control Policy and Procedures","uuid": "ebf10522-0f57-4880-aa73-e28a206b7be4"}],"uuid": "cfd2cd50-95fa-4143-b0e5-794249bacae1","version": "5.0"}'
# curl -i --user username:password \
    -H "Content-Type: application/json" \
    -H "Accept: application/json" -X POST \
    -d '{"name":"NIST","description":"Recommended Security Controls for Federal Information Systems and Organizations. (Rev.5)" ,"org_id":3,"schema_id":12,"json_object":'"$json_object"'}' \
    https://objects.monarc.lu/api/v1/json_object

HTTP/1.0 201 CREATED
Content-Type: application/json
Content-Length: 2392
Location: https://objects.monarc.lu/api/v1/json_object/30
Vary: Accept, Cookie
Content-Type: application/json
Date: Thu, 21 Feb 2019 09:34:39 GMT
----

The content of the newly created object is also returned.



=== More complex query

Getting all objects owned by the MONARC organization:
[source,bash]
----
https://objects.monarc.lu/api/v1/json_object?q={"name":"organization","op":"has","val":{"name":"name","op":"eq","val": "MONARC"}}
----


Getting all schemas owned by the MONARC organization:
[source,bash]
----
https://objects.monarc.lu/api/v1/schema?q={"filters":[{"name":"organization","op":"has","val":{"name":"name","op":"eq","val":"MONARC"}}]}
----



[source,bash]
----
https://objects.monarc.lu/api/v1/json_object?q={"name":"schema","op":"has","val":{"name":"name","op":"eq","val": "Security referentials"}}
----



== Permissions

This section details the management of permissions in MOSP.

=== Schemas

Schemas are always public.

You can only create an object in one of the organizations your account is
linked to.

In order to edit a schema your account must be linked to the owning
organization of the schema.


=== Objects

An object can be public or private (draft mode).

You can only create an object in one of the organizations your account is
linked to.
Since all schemas are public you can instantiate a new object with the
schema of your choice.

In order to see a private object or to edit an object your account
should be linked to the owning organization of this object.


